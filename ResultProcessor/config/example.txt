# $Id: $
#
### Example config file
#
# MrRA2 is a configurable tool to produce control plots and print event
# yields and information for different selections of data from ROOT trees.
#
# This is an example configuration file explaining the various options to
# MrRA2. The file runs on the input files prefixed with 'Example' residing
# in 'ResultProcessor/input'.
#
# The general syntax is '<key> :: <name>: <value>[; <name>: <value>; ...]'.
# Sometimes, values can be comma-separated lists of values.
# The following characters are used as separators and may in general not be
# used in keys, names, or values: '+', ',', ':', ';'. Spaces should be safe.
# Lines starting with an '#' and empty lines are ignored.
#
# The tool runs on any ROOT tree containing basic variable types (except booleans).
# It has been developed, though, for application in a SUSY search (RA2), which
# is reflected in the plotting options.

global:: debug: true


### Global parameters
# All global parameters are optional

# Publication status <internal,preliminary,public> defines the plotting
# style. For example, in case of 'preliminary' the header contains
# "CMS Preliminary". The default status in 'internal'. 
global :: publication status: preliminary
# Luminosity in 1/fb; used to label plots, i.e. there is no weighting
# functionality etc.
global :: lumi: 19.47
# The input path is preprended to the input file names defined below
# in the dataset section. 
global :: input path: input
# Output file-names are prefixed with 'id'
global :: id: Example
# Comma-separated list of output formats. The supported formats are
# pdf, png, and eps. Default is pdf.
global :: output formats: pdf, png


### Variables
# The variables that are read from the ntuple and their type. Each line
# with key 'variable' defines a new variable.
#
# The mandatory names are:
# - name: variable's name in the ROOT tree
# - type: ROOT-like variable type. Supported are
#     - Double_t,
#     - Float_t,
#     - UShort_t,
#     - Int_t,
#     - UInt_t,
#     - UChar_t
#
# Optionally, a TLatex-style label and a unit used in the plots can
# be defined, e.g. '#eta_{1}'.
variable :: name: RunNum; type: UInt_t
variable :: name: LumiBlockNum; type: UInt_t
variable :: name: EvtNum; type: UInt_t
variable :: name: HT; type: Float_t; label: H_{T}; unit: GeV
variable :: name: MHT; type: Float_t; label: #slash{H}_{T}; unit: GeV
variable :: name: NJets; type: UShort_t; label: N(Jets)
variable :: name: NVtx; type: UShort_t; label: N(Vtx)
variable :: name: Jet1Pt; type: Float_t; label: p_{T,1}; unit: GeV
variable :: name: Jet2Pt; type: Float_t; label: p_{T,2}; unit: GeV
variable :: name: Jet3Pt; type: Float_t; label: p_{T,3}; unit: GeV
variable :: name: Jet1Eta; type: Float_t; label: #eta_{1}
variable :: name: Jet2Eta; type: Float_t; label: #eta_{2}
variable :: name: Jet3Eta; type: Float_t; label: #eta_{3}
variable :: name: DeltaPhi1; type: Float_t; label: #Delta#Phi_{1}
variable :: name: DeltaPhi2; type: Float_t; label: #Delta#Phi_{2}
variable :: name: DeltaPhi3; type: Float_t; label: #Delta#Phi_{3}
variable :: name: Weight; type: Float_t



### Input datasets
# The input trees, dataset specifications, and optional weights and uncertainties.
# Each line with key 'dataset' defines a new dataset.
#
# The mandatory names are:
# - label: a unique label for this dataset. The label is used to identify the dataset
#          in other config definitions and as part of the output file names. It will
#          also be printed in plot labels, where TLatex-style syntax is correctly
#          interpreted, but for the ease of the config file language (you don't want
#          to type 'Z#rightarrow#nu#bar{#nu}' several times in this config file!),
#          the printed dataset label can optionally be defined (see below 'plot style').
# - type: type of data which defines the plotting style. The types are
#         - data
#         - mc
#         - mcprediction (for mc-based background prediction)
#         - prediction (for data-based background prediction)
#         - signal (for simulated signal processes)
# - files: list of names of the ROOT files containing the trees. If 'input path' is specified under
#         'global', the input path is prepended.
# - tree: name of the TTree inside the file. If this dataset contains several input files, each
#         needs to have the same tree name.
#
# Optional names are:
# - weight: name of a tree variable (as specified above) used as an event weight.
# - scales: list of constant event weights (numbers). If 'weight' is specified, the scale is
#           multiplied to the weight. There can be either one scale applied to all events in all
#           files of this dataset or n scales, where n equals the number of files in this dataset
#           and the i-th scale factor is applied to the events in the i-th file.  
dataset :: label: Data; type: data; files: Example_Data_All.root; tree: RA2TreeMaker/RA2PreSelection;

dataset :: label: TTbar; type: mc; files: Example_TTJets.root; tree: RA2TreeMaker/RA2PreSelection; weight: Weight;

dataset :: label: QCD; type: mc; files: Example_QCD_1.root, Example_QCD_2.root; tree: RA2TreeMaker/RA2PreSelection; weight: Weight;

dataset :: label: ZJets; type: mc; files: Example_ZJets.root; tree: RA2TreeMaker/RA2PreSelection; weight: Weight;

dataset :: label: WJets; type: mc; files: Example_WJets.root; tree: RA2TreeMaker/RA2PreSelection; weight: Weight;





### Event selection
# Event selections based on the variables defined above. Each line with key
# 'selection' defines a new selection; plots and event yields are produced
# for each selection individually.
#
# The mandatory names are:
# - label: unique label used to reference the selection in this config file,
#          to name the output files, and as labels in plots (TLatex-style
#          expressions are correctly interpreted).
# - cuts: series of cuts and previously defined selections. Cuts are of the
#         form 'VAR OP X', 'X OP VAR', or 'X1 OP VAR OP X2', where VAR is any
#         of the variables defined above, OP is any of the comparison operators
#         '>,>=,<,<=,==,!=', and X is a number. (Care should be taken with the
#         the equality operator '==' due to possible rounding issues. It should
#         be safe to use for any integer-type variable.) Cuts and previously
#         defined selections can be combined to a boolean expression using 
#         c++-style boolean operators '&&' (AND), '||' (OR), and '!' (NOT), where
#         parentheses can be used. (Ordering of && and || is not implemented, i.e.
#         the behaviour of an expression 'A && B || C' is not well defined. Use
#         parentheses to define the order!)
#
# Optional parameters are:
# - apply to: list of dataset names. If given, the selection will be applied only
#             to the specified datasets. This is also true if the selection is
#             reused in a later selection, i.e. if selection A is to be applied
#             only to certain datasets, this restriction remains if A is part of
#             selection B, but only for the cuts of A.
# - print: print the selection details.
selection :: label: cleaned; cuts: !(RunNum == 190782 && EvtNum == 368722920) && !(RunNum==190782 && EvtNum == 369785661)
selection :: label: baseline; cuts: cleaned && DeltaPhi1 > 0.5 && DeltaPhi2 > 0.5 && DeltaPhi3 > 0.3
selection :: label: 5 #leq N_{jets} #leq 7; cuts: baseline && 5 <= NJets <= 7
selection :: print: true



# Specify what variables to plot and some style settings
plot style :: dataset: Data; plot label: Data; marker: 20; color: 1
plot style :: dataset: TTbar; plot label: t#bar{t}; color: kRed+1
plot style :: dataset: QCD; plot label: QCD; color: kRed+3
plot style :: dataset: ZJets; plot label: Z#rightarrow#nu#bar{#nu}+Jets; color: kYellow
plot style :: dataset: WJets; plot label: W#rightarrowl#nu+Jets; color: kGreen+1

# Plot a single spectrum
plot :: variable: HT; dataset: Data; histogram: 45, 500, 5000, logy
plot :: variable: MHT; dataset: Data; histogram:  36, 200, 2000, logy

# Plot stack of several datasets
plot :: variable: HT; dataset: QCD + TTbar + ZJets + WJets; histogram: 45, 500, 5000, logy
plot :: variable: NJets; dataset: QCD + TTbar + ZJets + WJets; histogram: 10, 2.5, 12.5, logy

# 2D plots
plot :: variable: MHT vs HT; dataset: Data; histogram: 45, 500, 5000, 36, 200, 2000, logz

# Compare spectra of several dataset
plot :: variable: NVtx; dataset: Data, QCD, TTbar, WJets, ZJets; histogram: 50, 0, 50, norm

# Plot the spectrum of 'data' in comparison to 'background' (including ratio plots)
# The spectra of different datasets can be stacked using '+'
plot :: variable: HT; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 35, 500, 4000, logy
plot :: variable: MHT; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 26, 200, 1500, logy
plot :: variable: NJets; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 20, -0.5, 19.5, logy
plot :: variable: Jet1Pt; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 37, 0, 1850, logy
plot :: variable: Jet2Pt; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 37, 0, 1850, logy
plot :: variable: Jet3Pt; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 37, 0, 1850, logy
plot :: variable: Jet1Eta; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 20, -5, 5
plot :: variable: Jet2Eta; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 20, -5, 5
plot :: variable: Jet3Eta; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 20, -5, 5
plot :: variable: DeltaPhi1; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 15, 0.3, 3.3
plot :: variable: DeltaPhi2; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 15, 0.3, 3.3
plot :: variable: DeltaPhi3; data: Data; background: QCD + TTbar + ZJets + WJets; histogram: 15, 0.3, 3.3


# Print event information for 50 events with largest HT
# and all events for selections 'baseline + N_{jets} > 7'
#print event info :: provenance variables: RunNum + LumiBlockNum + EvtNum
#print event info :: highest: HT, 50
#print event info :: selections: baseline + N_{jets} > 7
